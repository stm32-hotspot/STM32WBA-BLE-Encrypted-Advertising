<h2><strong>BLE_p2pServer_EAD_Ext Application Description</strong></h2>
<p>How to demonstrate Point-to-Point communication using BLE (as GATT server).</p>
<p>p2pServer_EAD_Ext application advertises and waits for a connection from:</p>
<ul>
<li>p2pClient_EAD_Ext application running on STM32WBAxx devices</li>
</ul>
<p>Once connected and bonded, p2pClient_EAD_Ext can read the Encrypted Data Key Material characteristic of p2pServer_EAD_Ext.
p2pServer_EAD_Ext encrypt advertising data and build advertising event.</p>
<h3><strong>Keywords</strong></h3>
<p>Connectivity, BLE, BLE protocol, BLE pairing, BLE profile, Advertising extension, EAD (Encrypted ADvertising)</p>
<h3><strong>Directory contents</strong></h3>
<ul>
<li>BLE_p2pServer_EAD_Ext/Core/Inc/app_common.h                                         App Common application configuration file for STM32WPAN Middleware</li>
<li>BLE_p2pServer_EAD_Ext/Core/Inc/app_conf.h                                           Application configuration file for STM32WPAN Middleware</li>
<li>BLE_p2pServer_EAD_Ext/Core/Inc/app_entry.h                                          Interface to the application </li>
<li>BLE_p2pServer_EAD_Ext/Core/Inc/main.h                                               Header for main.c file. This file contains the common defines of the application</li>
<li>BLE_p2pServer_EAD_Ext/Core/Inc/stm32wbaxx_hal_conf.h                                HAL configuration file</li>
<li>BLE_p2pServer_EAD_Ext/Core/Inc/stm32wbaxx_it.h                                      This file contains the headers of the interrupt handlers</li>
<li>BLE_p2pServer_EAD_Ext/Core/Inc/stm32wbaxx_nucleo_conf.h                             STM32WBAXX nucleo board configuration file. This file should be copied to the application folder and renamed to stm32wbaxx_nucleo_conf.h</li>
<li>BLE_p2pServer_EAD_Ext/Core/Inc/utilities_conf.h                                     Header for configuration file for STM32 Utilities</li>
<li>BLE_p2pServer_EAD_Ext/STM32_WPAN/App/adv_ext_app.h                                  Advertising extended application header file</li>
<li>BLE_p2pServer_EAD_Ext/STM32_WPAN/App/app_ble.h                                      Header for ble application </li>
<li>BLE_p2pServer_EAD_Ext/STM32_WPAN/App/ble_conf.h                                     Configuration file for BLE Middleware</li>
<li>BLE_p2pServer_EAD_Ext/STM32_WPAN/App/ble_dbg_conf.h                                 Debug configuration file for BLE Middleware</li>
<li>BLE_p2pServer_EAD_Ext/STM32_WPAN/App/p2p_server.h                                   Header for p2p_server.c </li>
<li>BLE_p2pServer_EAD_Ext/STM32_WPAN/App/p2p_server_app.h                               Header for p2p_server_app.c </li>
<li>BLE_p2pServer_EAD_Ext/STM32_WPAN/Target/bpka.h                                      This file contains the interface of the BLE PKA module</li>
<li>BLE_p2pServer_EAD_Ext/STM32_WPAN/Target/host_stack_if.h                             This file contains the interface for the stack tasks </li>
<li>BLE_p2pServer_EAD_Ext/STM32_WPAN/Target/ll_sys_if.h                                 Header file for ll_sys_if.c</li>
<li>BLE_p2pServer_EAD_Ext/System/Config/ADC_Ctrl/adc_ctrl_conf.h                               Configuration Header for ADC controller module </li>
<li>BLE_p2pServer_EAD_Ext/System/Config/CRC_Ctrl/crc_ctrl_conf.h                               Configuration Header for CRC controller module </li>
<li>BLE_p2pServer_EAD_Ext/System/Config/Debug_GPIO/app_debug.h                          Real Time Debug module application APIs and signal table </li>
<li>BLE_p2pServer_EAD_Ext/System/Config/Debug_GPIO/app_debug_signal_def.h               Real Time Debug module application signal definition </li>
<li>BLE_p2pServer_EAD_Ext/System/Config/Debug_GPIO/debug_config.h                       Real Time Debug module general configuration file </li>
<li>BLE_p2pServer_EAD_Ext/System/Config/Flash/simple_nvm_arbiter_conf.h                 Configuration header for simple_nvm_arbiter.c module </li>
<li>BLE_p2pServer_EAD_Ext/System/Config/Log/log_module.h                                       Configuration Header for log module </li>
<li>BLE_p2pServer_EAD_Ext/System/Config/LowPower/app_sys.h                              Header for app_sys.c </li>
<li>BLE_p2pServer_EAD_Ext/System/Config/LowPower/peripheral_init.h                             Header for peripheral init module </li>
<li>BLE_p2pServer_EAD_Ext/System/Config/LowPower/user_low_power_config.h                Header for user_low_power_config.c</li>
<li>BLE_p2pServer_EAD_Ext/System/Interfaces/hw.h                                        This file contains the interface of STM32 HW drivers</li>
<li>BLE_p2pServer_EAD_Ext/System/Interfaces/hw_if.h                                     Hardware Interface </li>
<li>BLE_p2pServer_EAD_Ext/System/Interfaces/stm32_lpm_if.h                              Header for stm32_lpm_if.c module (device specific LP management) </li>
<li>BLE_p2pServer_EAD_Ext/System/Interfaces/timer_if.h                                  configuration of the timer_if.c instances </li>
<li>BLE_p2pServer_EAD_Ext/System/Interfaces/usart_if.h                                  Header file for stm32_adv_trace interface file </li>
<li>BLE_p2pServer_EAD_Ext/System/Modules/adc_ctrl.h                                     Header for ADC client manager module </li>
<li>BLE_p2pServer_EAD_Ext/System/Modules/ble_timer.h                                    This header defines the timer functions used by the BLE stack </li>
<li>BLE_p2pServer_EAD_Ext/System/Modules/crc_ctrl.h                                            Header for CRC client manager module </li>
<li>BLE_p2pServer_EAD_Ext/System/Modules/dbg_trace.h                                    Header for dbg_trace.c </li>
<li>BLE_p2pServer_EAD_Ext/System/Modules/otp.h                                          Header file for One Time Programmable (OTP) area </li>
<li>BLE_p2pServer_EAD_Ext/System/Modules/scm.h                                          Header for scm.c module </li>
<li>BLE_p2pServer_EAD_Ext/System/Modules/stm_list.h                                     Header file for linked list library</li>
<li>BLE_p2pServer_EAD_Ext/System/Modules/temp_measurement.h                                    Header file for temperature measurement module</li>
<li>BLE_p2pServer_EAD_Ext/System/Modules/utilities_common.h                             Common file to utilities </li>
<li>BLE_p2pServer_EAD_Ext/System/Modules/baes/baes.h                                    This file contains the interface of the basic AES software module</li>
<li>BLE_p2pServer_EAD_Ext/System/Modules/baes/baes_global.h                             This file contains the internal definitions of the AES software module</li>
<li>BLE_p2pServer_EAD_Ext/System/Modules/Flash/flash_driver.h                           Header for flash_driver.c module </li>
<li>BLE_p2pServer_EAD_Ext/System/Modules/Flash/flash_manager.h                          Header for flash_manager.c module </li>
<li>BLE_p2pServer_EAD_Ext/System/Modules/Flash/rf_timing_synchro.h                      Header for rf_timing_synchro.c module </li>
<li>BLE_p2pServer_EAD_Ext/System/Modules/Flash/simple_nvm_arbiter.h                     Header for simple_nvm_arbiter.c module </li>
<li>BLE_p2pServer_EAD_Ext/System/Modules/Flash/simple_nvm_arbiter_common.h              Common header of simple_nvm_arbiter.c module </li>
<li>BLE_p2pServer_EAD_Ext/System/Modules/MemoryManager/advanced_memory_manager.h        Header for advance_memory_manager.c module </li>
<li>BLE_p2pServer_EAD_Ext/System/Modules/MemoryManager/stm32_mm.h                       Header for stm32_mm.c module </li>
<li>BLE_p2pServer_EAD_Ext/System/Modules/Nvm/nvm.h                                      This file contains the interface of the NVM manager</li>
<li>BLE_p2pServer_EAD_Ext/System/Modules/RFControl/rf_antenna_switch.h                  RF related module to handle dedictated GPIOs for antenna switch</li>
<li>BLE_p2pServer_EAD_Ext/System/Modules/RTDebug/debug_signals.h                        Real Time Debug module System and Link Layer signal definition </li>
<li>BLE_p2pServer_EAD_Ext/System/Modules/RTDebug/local_debug_tables.h                   Real Time Debug module System and Link Layer signal </li>
<li>BLE_p2pServer_EAD_Ext/System/Modules/RTDebug/RTDebug.h                              Real Time Debug module API declaration </li>
<li>BLE_p2pServer_EAD_Ext/System/Modules/RTDebug/RTDebug_dtb.h                          Real Time Debug module API declaration for DTB usage</li>
<li>BLE_p2pServer_EAD_Ext/System/Modules/SerialCmdInterpreter/serial_cmd_interpreter.h         Header file for the serial commands interpreter module</li>
<li>BLE_p2pServer_EAD_Ext/Core/Src/app_entry.c                                          Entry point of the application </li>
<li>BLE_p2pServer_EAD_Ext/Core/Src/main.c                                               Main program body </li>
<li>BLE_p2pServer_EAD_Ext/Core/Src/stm32wbaxx_hal_msp.c                                 This file provides code for the MSP Initialization and de-Initialization codes.</li>
<li>BLE_p2pServer_EAD_Ext/Core/Src/stm32wbaxx_it.c                                      Interrupt Service Routines. </li>
<li>BLE_p2pServer_EAD_Ext/Core/Src/system_stm32wbaxx.c                                  CMSIS Cortex-M33 Device Peripheral Access Layer System Source File </li>
<li>BLE_p2pServer_EAD_Ext/STM32_WPAN/App/adv_ext_app.c                                  Advertising extended application file</li>
<li>BLE_p2pServer_EAD_Ext/STM32_WPAN/App/app_ble.c                                      BLE Application </li>
<li>BLE_p2pServer_EAD_Ext/STM32_WPAN/App/p2p_server.c                                   p2p_server definition</li>
<li>BLE_p2pServer_EAD_Ext/STM32_WPAN/App/p2p_server_app.c                               p2p_server_app application definition</li>
<li>BLE_p2pServer_EAD_Ext/STM32_WPAN/Target/bleplat.c                                   This file implements the platform functions for BLE stack library</li>
<li>BLE_p2pServer_EAD_Ext/STM32_WPAN/Target/bpka.c                                      This file implements the BLE PKA module</li>
<li>BLE_p2pServer_EAD_Ext/STM32_WPAN/Target/host_stack_if.c                             Source file for the stack tasks </li>
<li>BLE_p2pServer_EAD_Ext/STM32_WPAN/Target/linklayer_plat.c                            Source file for the linklayer plateform adaptation layer </li>
<li>BLE_p2pServer_EAD_Ext/STM32_WPAN/Target/ll_sys_if.c                                 Source file for initiating the system sequencer </li>
<li>BLE_p2pServer_EAD_Ext/STM32_WPAN/Target/power_table.c                               This file contains supported power tables </li>
<li>BLE_p2pServer_EAD_Ext/System/Config/ADC_Ctrl/adc_ctrl_conf.c                               Source for ADC client controller module configuration file </li>
<li>BLE_p2pServer_EAD_Ext/System/Config/CRC_Ctrl/crc_ctrl_conf.c                               Source for CRC client controller module configuration file </li>
<li>BLE_p2pServer_EAD_Ext/System/Config/Debug_GPIO/app_debug.c                          Real Time Debug module application side APIs </li>
<li>BLE_p2pServer_EAD_Ext/System/Config/Log/log_module.c                                       Source file of the log module </li>
<li>BLE_p2pServer_EAD_Ext/System/Config/LowPower/user_low_power_config.c                Low power related user configuration</li>
<li>BLE_p2pServer_EAD_Ext/System/Config/LowPower/peripheral_init.c                             Source for peripheral init module </li>
<li>BLE_p2pServer_EAD_Ext/System/Interfaces/hw_aes.c                                    This file contains the AES driver for STM32WBA </li>
<li>BLE_p2pServer_EAD_Ext/System/Interfaces/hw_otp.c                                    This file contains the OTP driver</li>
<li>BLE_p2pServer_EAD_Ext/System/Interfaces/hw_pka.c                                    This file contains the PKA driver for STM32WBA </li>
<li>BLE_p2pServer_EAD_Ext/System/Interfaces/hw_rng.c                                    This file contains the RNG driver for STM32WBA </li>
<li>BLE_p2pServer_EAD_Ext/System/Interfaces/pka_p256.c                                  This file is an optional part of the PKA driver for STM32WBA. It is dedicated to the P256 elliptic curve</li>
<li>BLE_p2pServer_EAD_Ext/System/Interfaces/stm32_lpm_if.c                              Low layer function to enter/exit low power modes (stop, sleep) </li>
<li>BLE_p2pServer_EAD_Ext/System/Interfaces/timer_if.c                                  Configure RTC Alarm, Tick and Calendar manager </li>
<li>BLE_p2pServer_EAD_Ext/System/Interfaces/usart_if.c                                  Source file for interfacing the stm32_adv_trace to hardware </li>
<li>BLE_p2pServer_EAD_Ext/System/Modules/adc_ctrl.c                                     Header for ADC client manager module </li>
<li>BLE_p2pServer_EAD_Ext/System/Modules/app_sys.c                                      Application system for STM32WPAN Middleware</li>
<li>BLE_p2pServer_EAD_Ext/System/Modules/ble_timer.c                                    This module implements the timer core functions </li>
<li>BLE_p2pServer_EAD_Ext/System/Modules/crc_ctrl.c                                            Source for CRC client controller module </li>
<li>BLE_p2pServer_EAD_Ext/System/Modules/otp.c                                          Source file for One Time Programmable (OTP) area </li>
<li>BLE_p2pServer_EAD_Ext/System/Modules/scm.c                                          Functions for the System Clock Manager</li>
<li>BLE_p2pServer_EAD_Ext/System/Modules/stm_list.c                                     TCircular Linked List Implementation</li>
<li>BLE_p2pServer_EAD_Ext/System/Modules/temp_measurement.c                                    Temperature measurement module</li>
<li>BLE_p2pServer_EAD_Ext/System/Modules/baes/baes_cmac.c                               This file contains the AES CMAC implementation</li>
<li>BLE_p2pServer_EAD_Ext/System/Modules/baes/baes_ecb.c                                This file contains the AES ECB functions implementation</li>
<li>BLE_p2pServer_EAD_Ext/System/Modules/Flash/flash_driver.c                           The Flash Driver module is the interface layer between Flash management modules and HAL Flash drivers</li>
<li>BLE_p2pServer_EAD_Ext/System/Modules/Flash/flash_manager.c                          The Flash Manager module provides an interface to write raw data from SRAM to FLASH</li>
<li>BLE_p2pServer_EAD_Ext/System/Modules/Flash/rf_timing_synchro.c                      The RF Timing Synchronization module provides an interface to synchronize the flash processing versus the RF activity to make sure the RF timing is not broken</li>
<li>BLE_p2pServer_EAD_Ext/System/Modules/Flash/simple_nvm_arbiter.c                     The Simple NVM arbiter module provides an interface to write and/or restore data from SRAM to FLASH with use of NVMs</li>
<li>BLE_p2pServer_EAD_Ext/System/Modules/MemoryManager/advanced_memory_manager.c        Memory Manager </li>
<li>BLE_p2pServer_EAD_Ext/System/Modules/MemoryManager/stm32_mm.c                       Memory Manager </li>
<li>BLE_p2pServer_EAD_Ext/System/Modules/Nvm/nvm_emul.c                                 This file implements the RAM version of the NVM manager for STM32WBX. It is made for test purpose</li>
<li>BLE_p2pServer_EAD_Ext/System/Modules/RFControl/rf_antenna_switch.c                  RF related module to handle dedictated GPIOs for antenna switch</li>
<li>BLE_p2pServer_EAD_Ext/System/Modules/RTDebug/RTDebug.c                              Real Time Debug module API definition </li>
<li>BLE_p2pServer_EAD_Ext/System/Modules/RTDebug/RTDebug_dtb.c                          Real Time Debug module API definition for DTB usage</li>
<li>BLE_p2pServer_EAD_Ext/System/Modules/SerialCmdInterpreter/serial_cmd_interpreter.c         Source file for the serial commands interpreter module</li>
</ul>
<h3><strong>Hardware and Software environment</strong></h3>
<ul>
<li>This application runs on STM32WBA55 Nucleo board.</li>
<li>Another STM32WBAxx Nucleo board is necessary to run p2pServer_EAD_Ext application.</li>
</ul>
<h3><strong>How to use it?</strong></h3>
<p>In order to make the program work, you must do the following :</p>
<ul>
<li><p>Open your preferred toolchain</p>
</li>
<li><p>Rebuild all files and load your image into target memory</p>
</li>
<li><p>Run the example</p>
</li>
<li><p>Power up p2pClient_EAD_Ext device next to p2pServer_EAD_Ext device.</p>
</li>
<li><p>p2pServer_EAD_Ext device starts advertising on reset.</p>
</li>
<li><p>Actions done from p2pClient_EAD_Ext application. Follow p2pClient_EAD_Ext readme to demonstrate EAD functionality.</p>
</li>
<li><p>When disconnection occurs, p2pServer_EAD_Ext restarts advertising.</p>
</li>
</ul>
